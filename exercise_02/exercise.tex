%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{../Ressources/Preamble.tex} % !!! DON'T TOUCH !!!
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newcommand{\ExerciseNumber}{01}

\newcommand{\PersonOne}{Marcel Bruckner (03674122)}
\newcommand{\PersonTwo}{Julian Hohenadel (03673879)}
\newcommand{\PersonThree}{Kevin Bein (03707775)}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% DOKUMENT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{../Ressources/Cover.tex} % !!! DON'T TOUCH !!!
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% !!! HOMEWORK STARTS HERE !!!
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\Topic{kNN Classification}
%
%
\Problem{1}
%
\begin{flushleft}a)\end{flushleft}
\begin{table}[!h]
\begin{tabular}{ll}
  L1-Norm: & $||x||_1 = \sum_{i=1}^n |x_i|$ \\
  L1-Distance: & $d_1(x_1,x_2) = |x_1 - x_2| = \sum_{i=1}^n |x_{1,i} - x_{2,i}|$ 
\end{tabular}
\end{table}
\begin{table}[!h]
\begin{tabular}{lll}
  $d_1(A,B) = 1.5$ & $d_1(B,A) = 1.5$ & $d_1(C,A) = 1.5$ \\
  $d_1(D,E) = 2.5$ & $d_1(E,F) = 1$ & $d_1(F,E) = 1$
\end{tabular}
\end{table}
%
\begin{flushleft}b)\end{flushleft}
\begin{table}[!h]
\begin{tabular}{ll}
  L2-Norm: & $||x||_2 = \sqrt{\sum_{i=1}^n |x_i|^2}$ \\
  L2-Distance: & $d_2(x_1,x_2) = \sqrt{|x_1-x_2|^2} = \sqrt{\sum_{n=1}^n |x_{1,i} - x_{2,i}|^2} $
\end{tabular}
\end{table}
\begin{table}[!h]
\begin{tabular}{lll}
  $d_2(A,B) \approx 1.12$ & $d_2(B,A) \approx 1.12$ & $d_2(C,A) \approx 1.5$ \\
  $d_2(D,C) \approx 2.2$ & $d_2(E,F) = 1$ & $d_2(F,E) = 1$ 
\end{tabular}
\end{table}
%
\begin{flushleft}
c) The nearest neighbors are the same but for point $D$. Here, the L1-Distance is smallest for point $E$ whereas with L2-Distance, the nearest point is $C$. Both have different advantages but in a 2D setting, L2 represents the closest point better (as can be visually confirmed).
\end{flushleft}

% Point A-F			Point A-F		a)	b)
% [[array([1., 1.]) array([1., 1.]) 0.0 0.0]
% [array([1., 1.]) array([2. , 0.5]) 1.5 1.118033988749895]
% [array([1., 1.]) array([1. , 2.5]) 1.5 1.5]
% [array([1., 1.]) array([3. , 3.5]) 4.5 3.2015621187164243]
% [array([1., 1.]) array([5.5, 3.5]) 7.0 5.1478150704935]
% [array([1., 1.]) array([5.5, 2.5]) 6.0 4.743416490252569]
% [array([2. , 0.5]) array([1., 1.]) 1.5 1.118033988749895]
% [array([2. , 0.5]) array([2. , 0.5]) 0.0 0.0]
% [array([2. , 0.5]) array([1. , 2.5]) 3.0 2.23606797749979]
% [array([2. , 0.5]) array([3. , 3.5]) 4.0 3.1622776601683795]
% [array([2. , 0.5]) array([5.5, 3.5]) 6.5 4.6097722286464435]
% [array([2. , 0.5]) array([5.5, 2.5]) 5.5 4.031128874149275]
% [array([1. , 2.5]) array([1., 1.]) 1.5 1.5]
% [array([1. , 2.5]) array([2. , 0.5]) 3.0 2.23606797749979]
% [array([1. , 2.5]) array([1. , 2.5]) 0.0 0.0]
% [array([1. , 2.5]) array([3. , 3.5]) 3.0 2.23606797749979]
% [array([1. , 2.5]) array([5.5, 3.5]) 5.5 4.6097722286464435]
% [array([1. , 2.5]) array([5.5, 2.5]) 4.5 4.5]
% [array([3. , 3.5]) array([1., 1.]) 4.5 3.2015621187164243]
% [array([3. , 3.5]) array([2. , 0.5]) 4.0 3.1622776601683795]
% [array([3. , 3.5]) array([1. , 2.5]) 3.0 2.23606797749979]
% [array([3. , 3.5]) array([3. , 3.5]) 0.0 0.0]
% [array([3. , 3.5]) array([5.5, 3.5]) 2.5 2.5]
% [array([3. , 3.5]) array([5.5, 2.5]) 3.5 2.692582403567252]
% [array([5.5, 3.5]) array([1., 1.]) 7.0 5.1478150704935]
% [array([5.5, 3.5]) array([2. , 0.5]) 6.5 4.6097722286464435]
% [array([5.5, 3.5]) array([1. , 2.5]) 5.5 4.6097722286464435]
% [array([5.5, 3.5]) array([3. , 3.5]) 2.5 2.5]
% [array([5.5, 3.5]) array([5.5, 3.5]) 0.0 0.0]
% [array([5.5, 3.5]) array([5.5, 2.5]) 1.0 1.0]
% [array([5.5, 2.5]) array([1., 1.]) 6.0 4.743416490252569]
% [array([5.5, 2.5]) array([2. , 0.5]) 5.5 4.031128874149275]
% [array([5.5, 2.5]) array([1. , 2.5]) 4.5 4.5]
% [array([5.5, 2.5]) array([3. , 3.5]) 3.5 2.692582403567252]
% [array([5.5, 2.5]) array([5.5, 3.5]) 1.0 1.0]
% [array([5.5, 2.5]) array([5.5, 2.5]) 0.0 0.0]]
% c) L2 is more accurate
%
%
\Problem{2}
%
\begin{flushleft}
  a) $x_new$ will be always be classified as as $C$ because when we set $k$ to be equal to the number of all points, the class with most points will win. In this case, it is $C$ with $64 > 32 > 16$.
\end{flushleft}
\begin{flushleft}
  b) It is not possible to make a clear statement here since the classification is based on the weights and these are unknown. Any class is possible depending on the kernel chosen.
\end{flushleft}
%
%
\Problem{3}
%
\begin{flushleft}
False, the feature test performed in a node is done by only evaluating one feature to split the training data. Therefore decision boundaries can only be parallel to the axis respectivly. This means that a decision tree at depth 1 can never produce a diagonal as shown in the plot. For that reason a huge depth would be needed to approximate the diagonal in a zig-zag like pattern.
\end{flushleft}
%
%
\Problem{4}
%
\\
\begin{table}[!h]
\begin{tabular}{ll}
  $i_H(t) = - \sum_{c_i \in C} \pi_{c_i} \log \pi_{c_i}$ with $\underset{x\rightarrow 0+}{\lim} x\log x = 0$ and $\pi_c = p(y=c|t)$ \\
  $P(y=W) = \frac{4}{10}$ \\
  $P(y=L) = \frac{6}{10}$
\end{tabular}
\end{table}
\begin{flushleft}
  a) 
  \begin{align*}
    i_H(y) &= - (p(y=W) \cdot \log p(y=W) + p(y=L) \cdot \log p(y=L)) \\
    &= -(\frac{4}{10} \cdot \log \frac{4}{10} + \frac{4}{10} \cdot \log \frac{6}{10}) \\
    &\approx 0.673012
  \end{align*}
\end{flushleft}
%
\Topic{Programming Task}
%
%
\Problem{5} See below
%
\includepdf[pages=-]{exercise_02_notebook.pdf}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% !!! HOMEWORK ENDS HERE !!!
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{../Ressources/Appendix.tex} % !!! DON'T TOUCH !!!
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}
